
<!DOCTYPE html>
<html>
<head>
  <!--
    Kilsbergen MkDocs theme copyright 2019 Ruud van Asseldonk.
    Licensed under the Apache 2.0 license.
    See https://github.com/ruuda/kilsbergen.
  -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Changelog — Musium</title>
  <!-- Out of the options of rsms.me + Google Fonts, self-hosting, and only
    Google Fonts, the latter is by far the fastest when the docs themselves are
    not on a CDN, even though it's two additional domains to connect to. -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&display=swap" rel="stylesheet">
  <link href="https://docs.ruuda.nl/musium/changelog/" rel="canonical">
  <style>
  /* Inter font family, copyright Rasmus Andersson, licensed under SIL OFL 1.1,
     see https://rsms.me/inter and https://rsms.me/inter/inter.css. */
  @font-face {
    font-family: 'Inter';
    font-style: normal;
    font-weight: 100 900;
    font-display: swap;
    src: url('https://rsms.me/inter/font-files/Inter-roman.var.woff2?v=3.19') format('woff2');
    font-named-instance: 'Regular';
  }
  @font-face {
    font-family: 'Inter';
    font-style: italic;
    font-weight: 100 900;
    font-display: swap;
    src: url('https://rsms.me/inter/font-files/Inter-italic.var.woff2?v=3.19') format('woff2');
    font-named-instance: 'Italic';
  }
  /* Modular scale with exponent 1.7^(1/3). The 1.7 was chosen as the line hight
     that goes well with Inter. Previously I used 1.59, but it was just too tight.
     0.59em
     0.70em
     1.00em
     1.19em
     1.42em
     1.70em
     2.02em
     2.42em
  */
  * { margin: 0; padding: 0; border-spacing: 0; }
  html {
    font-family: Inter, Roboto, sans-serif;
    /*
    Turn on character variant 8 for Inter, which puts serifs on the uppercase I.
    Also turn on variant 1, which has a curved 1.
    Disable contextual alternates for now. There is a bug, either in Inter or
    in Chrome (https://crbug.com/1046095) that causes colons after a <strong> to
    be raised above the baseline.
    */
    font-feature-settings: 'cv01' 1, 'cv08' 1, 'calt' 0;

    font-size: 16px;
    line-height: 1.7em;
    background-color: #fff;
    height: 100%;
  }
  em {
    font-style: italic;
  }
  body {
    height: 100%;
  }
  #content {
    display: grid;
    grid-template-columns: auto 16rem 50rem auto;
    color: #333;
    min-height: 100%;
  }
  #main {
    grid-area: 1 / 3 / 2 / 4;
    padding: 2.2rem;
    padding-left: 4rem;
    padding-right: 4rem;
    overflow: hidden;
  }
  #breadcrumbs {
    margin-bottom: 3rem;
    word-spacing: 0.3em;
    color: #78a;
  }
  #breadcrumbs a {
    word-spacing: 0;
    color: #78a;
  }
  article {
    margin-top: 1.3rem;
  }
  h1, h2, h3 {
    font-weight: 600;
    font-size: 1rem;
    color: #444;
    position: relative;
  }
  h1 {
    font-size: 2rem;
    margin-bottom: 2.1rem;
    line-height: 2.42rem;
    margin-top: -0.35rem;
    margin-bottom: 1.75rem;
  }
  h2 {
    font-size: 1.42rem;
    margin-top: 3.5rem;
    margin-bottom: 1.6rem;
  }
  .headerlink {
    position: absolute;
    left: -0.9em;
    width: 1em;
    opacity: 0.0;
    transition: opacity 0.2s ease-in;
  }
  /* Don't show the link for h1, usually you only have a single h1 at the top
     of the page, so it doesn't make much sense to add an anchor there, and with
     the larger font size, it doesn't fit in a narrow viewport. */
  h2:hover .headerlink, h3:hover .headerlink {
    opacity: 1.0;
  }
  code {
    font-family: 'Roboto Mono', monospace;
    font-size: 0.84rem;
    line-height: 1.5rem;
  }
  h3 > code {
    /* Roboto Mono 500 is about as heavy as Inter semibold (600). */
    font-weight: 500;
  }
  abbr {
    text-transform: uppercase;
    /* Downsize so caps are x-height, and compensate weight loss. */
    font-size: 0.78rem;
    font-weight: 500;
    letter-spacing: 0.05rem;
    /* Prevent abbrs from changing the line height of lines in which they occur. */
    line-height: 0;
  }
  sub, sup {
    /* Don't disturb the line height of normal text. */
    line-height: 0rem;
    font-size: 0.78rem;
    font-weight: 500;
  }
  p > code,
  a > code,
  h3 > code,
  li > code,
  td > code,
  dt > code,
  dd > code {
    background-color: #f0f0f0;
    padding: 0.13rem;
    padding-left: 0.3rem;
    padding-right: 0.3rem;
    border-radius: 0.2rem;
    line-height: 1rem;
  }
  h3 {
    padding-top: 0.9rem;
    padding-bottom: 0.8rem;
  }
  h3 > code {
    margin-left: -0.1rem;
  }
  a {
    color: #36d;
    text-decoration: none;
  }
  p, ul, ol, dl, pre, table {
    /* Same space as line height, leave exactly one line blank. */
    margin-bottom: 1.7rem;
  }
  pre {
    padding-top: 0.8rem;
    padding-bottom: 0.9rem;
    padding-left: 1.19rem;
    padding-right: 0;
    background-color: #f8f8f8;
    border-radius: 0 0.2rem 0.2rem 0;
    border-left: 0.3rem solid #d5d8e0;
    overflow-x: auto;
  }
  pre > code {
    margin-right: 1.41rem;
    color: #555;
  }
  code .k { color: #36d; }
  code .kt, code .nb { color: #d36; }
  code .c1, code .cm { color: #d36; font-style: italic; }
  code .s { color: #c43; }
  ul, ol {
    list-style-type: none;
    counter-reset: item;
  }
  table {
    font-variant-numeric: tabular-nums;
  }
  th, td {
    padding-right: 2rem;
  }
  th {
    text-align: left;
  }
  td > img {
    display: block;
    padding-top: 1em;
    padding-bottom: 1em;
  }
  dl {
    display: grid;
    grid-template-columns: 1fr 4fr;
    grid-column-gap: 2em;
  }
  dl dt {
    text-align: right;
  }
  #main ul li:before {
    color: #555;
    content: '\2022';
    display: inline-block;
    font-weight: 700;
    margin-left: -0.9rem;
    width: 0.9rem;
  }
  #main ul li {
    margin-left: 0.87rem;
  }
  #main ol li:before {
    content: counter(item);
    display: inline-block;
    font-weight: 700;
    width: 0.8rem;
    margin-left: -1.6rem;
    padding-right: 0.8rem;
  }
  #main ol li {
    margin-left: 1.6rem;
    counter-increment: item;
  }
  #nav-prev-next {
    margin-top: 3.4rem;
    padding-bottom: 3.3rem;
  }
  #nav-prev, #nav-next, #repo-link {
    display: inline-block;
  }
  #nav-prev {
    float: left;
  }
  #nav-next, #repo-link {
    float: right;
    text-align: right;
  }
  #nav-prev::before {
    content: '\219e';
    padding-right: 0.5em;
  }
  #nav-next::after {
    content: '\21a0';
    padding-left: 0.5em;
  }
  aside {
    grid-area: 1 / 1 / 2 / 3;
    border-right: 1px solid #eee;
    background-color: #fafafa;
    color: #78a;
  }
  aside nav {
    margin-top: 9rem;
    padding-bottom: 3.4rem;
    width: 14rem;
    float: right;
    /* Put the active chapter border over the sidebar border. */
    margin-right: -1px;
  }
  aside a {
    color: inherit;
  }
  aside .toc-section {
    font-weight: 700;
  }
  aside ul {
    margin-bottom: 0;
  }
  aside li {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  aside li ul {
    padding-top: 0.6rem;
    padding-bottom: 1.1rem;
  }
  aside li.toc-section {
    margin-top: 1.7rem;
  }
  aside li.toc-section {
    color: #36d;
  }
  aside li.current, aside li ul {
    border-right: 0.3em solid #d5d8e0;
    padding-left: 1em;
    margin-left: -1em;
  }
  aside li.toc-chapter.current {
    font-weight: 600;
  }
  aside li.toc-heading {
    padding-left: 1em;
    padding-right: 0.3em;
  }

  @media(max-width: 63rem)
  {
    #content {
      /* Manual implementation of max-width: on narrower viewports,
         auto-size the body. */
      grid-template-columns: 0 16rem auto 0;
    }
  }

  @media(max-width: 1150px)
  {
    html { font-size: 15px; }
  }

  /* Move the sidebar TOC below content at small widths. */
  @media(max-width: 800px)
  {
    #content {
      display: block;
    }
    aside {
      border-top: 1px solid #eee;
      border-right: 0px none;
      padding-top: 1.7em;
    }
    aside nav {
      margin-left: 4em;
      margin-top: 1.7em;
      margin-right: 0;
      float: none;
      width: auto;
    }
    #main {
      padding-bottom: 1.7em;
    }
    /* Now that the TOC is full-width, adding the border on the right to
       highlight the active page is not as clear anymore, it can be far away.
       The current chapter is still in boldface, but that does not work for
       section indexes. So point a guillemet at it as well. */
    aside li.current, aside li ul {
      border-right: 0px none;
      position: relative;
    }
    aside li.current:before {
      content: '\203a';
      position: absolute;
      left: 0;
    }
  }

  /* Use less generous margins for very narrow viewports. */
  @media(max-width: 650px)
  {
    #main {
      padding-left: 2rem;
      padding-right: 2rem;
    }
    aside nav {
      margin-left: 2rem;
      padding-bottom: 2rem;
    }
  }

  @media(max-width: 450px)
  {
    #main {
      padding-left: 1.7em;
      padding-right: 1.7em;
    }
    aside nav {
      margin-left: 1.7em;
    }
  }
  </style>
</head>
<body>
  <div id="content">
    <div id="main">
      <nav id="breadcrumbs">
        <a href="https://docs.ruuda.nl/musium/">Musium</a>
         › <a href="../building/">User Guide</a> 
         › <a href="./">Changelog</a> 
        <a id="repo-link" href="https://github.com/ruuda/musium/">GitHub</a>
      </nav>
      <article>
        <h1 id="changelog">Changelog<a class="headerlink" href="#changelog">&para;</a></h1>
<p>Musium follows a “rolling release” or “nightly” development process. I compile
and run <code>master</code> shortly after I make changes. However, sometimes there are
notable changes, and especially if they require manual intervention, it is
useful to write them down in a changelog.</p>
<p>Musium only started tagging releases in February 2023. Versions prior to 0.11.0
have been tagged as such retroactively to mark notable milestones. Those tags
were not present at the time.</p>
<h2 id="versioning-policy">Versioning policy<a class="headerlink" href="#versioning-policy">&para;</a></h2>
<p>Musium versions are named <code>MAJOR.MINOR.PATCH</code>.</p>
<ul>
<li>The major version number is purely cosmetic and represents the author’s
   sentiment about feature-completeness.</li>
<li>The minor version is bumped when new features are added and when user
   intervention is required to update (for example, a change in the config file,
   or a migration of the database).</li>
<li>The patch version is bumped for bugfixes and other small changes.</li>
</ul>
<h2 id="unreleased">Unreleased<a class="headerlink" href="#unreleased">&para;</a></h2>
<ul>
<li>Nothing notable so far.</li>
</ul>
<h2 id="0110">0.11.0<a class="headerlink" href="#0110">&para;</a></h2>
<p>Released 2023-04-10.</p>
<ul>
<li><strong>Breaking:</strong> Musium now supports multiple artists per album. However, to be
   able to support this, the database schema has changed significantly. To
   migrate, back up the old database, then migrate listens and import timestamps
   using <code>tools/migrate_0.11.0.py</code>.</li>
<li><strong>Breaking:</strong> The <code>data_path</code> configuration option was renamed to <code>db_path</code>,
   Musium was not storing anything in the data path aside from the database
   anyway. Unlike <code>data_path</code>, <code>db_path</code> should include the file name.</li>
<li><strong>Breaking:</strong> Cover art thumbnails are now stored in the database. The
   <code>covers_path</code> configuration option has been removed.</li>
<li>The Nix-based development environment that was using a Nix 2.3-compatible
   <code>default.nix</code> has been replaced with a flake that requires Nix 2.10 or later.</li>
<li>Database boilerplate is now generated by <a href="https://docs.ruuda.nl/squiller/">Squiller</a>.</li>
</ul>
<h2 id="0101">0.10.1<a class="headerlink" href="#0101">&para;</a></h2>
<p>Authored 2023-02-18, but tagged retroactively on 2023-02-26.</p>
<ul>
<li><strong>Breaking:</strong> Requires Rust 1.57.0 to build.</li>
<li>Make the webinterface more responsive.</li>
<li>Increase the priority of the playback thread to reduce the probability
   of a buffer underrun when the system is under load.</li>
<li>Update dependencies, small improvements and fixes.</li>
</ul>
<h2 id="0100">0.10.0<a class="headerlink" href="#0100">&para;</a></h2>
<p>Authored 2022-03-06, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add support for a pre-playback and post-idle command. This can be used to
   e.g. power speakers on and off. See also the included instructions for
   <a href="../tradfri/">controlling Ikea Trådfri wireless control outlets</a>.</li>
<li>Display a “waveform” of the track on the <em>now playing</em> pane. The shape is
   technically not the sound wave, instead it represents loudness over time.</li>
<li>To power this new feature, compute loudness information during scanning, and
   store it in the database. Album and track loudness is also computed, although
   at this point this data is unused and Musium still relies on loudness
   metadata in tags.</li>
</ul>
<p>Note: In November 2021 Linux 5.15 was released. This kernel contains a
regression in the <abbr>ALSA</abbr> subsystem that breaks Musium when switching
between different sample rates or bit depths. Linux 5.10.94 is the last version
without this regression.</p>
<h2 id="090">0.9.0<a class="headerlink" href="#090">&para;</a></h2>
<p>Authored 2021-10-16, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add an <em>About</em> pane on the webinterface that shows statistics about the
   library.</li>
<li>Add the ability to trigger a scan from the webinterface without having to
   restart the process.</li>
</ul>
<h2 id="080">0.8.0<a class="headerlink" href="#080">&para;</a></h2>
<p>Authored 2021-08-01, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add a high-pass filter to make playback of bass-heavy albums more pleasant
   when the room acoustics are suboptimal. (Or just for when you are afraid that
   turning up the volume would disturb the neighbors.)</li>
<li>Fix a rare hang during playback.</li>
</ul>
<h2 id="070">0.7.0<a class="headerlink" href="#070">&para;</a></h2>
<p>Authored 2021-06-19, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add queue size indicator on the queue tab in the webinterface.</li>
<li>Cache file metadata in the SQLite database to improve startup performance.
   Musium no longer scans the metadata of all files at startup, instead it loads
   metadata from the database, and a separate <code>scan</code> command updates the
   database.</li>
</ul>
<h2 id="060">0.6.0<a class="headerlink" href="#060">&para;</a></h2>
<p>Authored 2021-05-29, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add an “enqueue” button for enqueueing entire albums.</li>
<li>Reduce stutter in webinterface animations.</li>
<li>Open the <em>now playing</em> page on first load if a track is playing.</li>
<li>Add keyboard shortcut for opening the search pane.</li>
<li>Make loudness normalization contextual. If multiple tracks from the same
   album play consecutively, we use the album loudness, to ensure that the album
   plays back exactly as it was mastered. When tracks from multiple albums are
   mixed in the play queue, use track loudness, to get more accurate loudness
   normalization.</li>
<li>Add support for notifying systemd of startup progress.</li>
<li>Move all <abbr>API</abbr> endpoints behind the <code>/api</code> path in the webserver,
   so <abbr>API</abbr> urls do not clash with app urls.</li>
</ul>
<h2 id="050">0.5.0<a class="headerlink" href="#050">&para;</a></h2>
<p>Authored 2021-04-03, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>List albums in reverse chronological order, instead of chronological.</li>
<li>Show a spinner in the webinterface when the track is buffering.</li>
<li>Enable opening the artist pane at first load if a track is playing.</li>
<li>Make more things clickable in the webinterface.</li>
<li>Fix display issues with non-square cover art.</li>
</ul>
<h2 id="040">0.4.0<a class="headerlink" href="#040">&para;</a></h2>
<p>Authored 2021-01-23, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Split the library and album view.</li>
<li>Add navigation buttons in the webinterface.</li>
<li>Add support for submitting listens to ListenBrainz, in addition to Last.fm.</li>
<li>Handle an audio buffer underrun that could occur in some situations.</li>
</ul>
<h2 id="031">0.3.1<a class="headerlink" href="#031">&para;</a></h2>
<p>Authored 2020-11-27, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Small tweaks to the <em>now playing</em> and search results pages.</li>
<li>Keep all thumbnails in memory, so no disk access is required to serve most of
   the webinterface.</li>
<li>Internal improvements to search, to better enable matching external listening
   history from ListenBrainz. The script to import listening history is still a
   work in progress.</li>
</ul>
<h2 id="030">0.3.0<a class="headerlink" href="#030">&para;</a></h2>
<p>Authored 2020-10-04, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Improvements to the webinterface, with multiple panes and animations.</li>
<li>Add the listens database, and a script to scrobble listens to Last.fm.
   Initially the script acted on the json play log, but the play log was quickly
   superseded by a SQLite database. At this point the database was not used for
   anything else, Musium would re-scan all files at startup.</li>
</ul>
<h2 id="020">0.2.0<a class="headerlink" href="#020">&para;</a></h2>
<p>Authored 2020-08-28, but tagged retroactively on 2023-02-26.</p>
<ul>
<li>Add support for loudness normalization, through <code>bs17704_track_loudness</code> and
   <code>bs17704_album_loudness</code> tags. These tags can be written by an external
   utility, <a href="https://github.com/ruuda/bs1770#tagging-flac-files"><code>flacgain</code> in the BS1770 library</a>.</li>
<li>Volume control in the webinterface.</li>
</ul>
<h2 id="010">0.1.0<a class="headerlink" href="#010">&para;</a></h2>
<p>Authored 2020-08-22, but tagged retroactively on 2023-02-26.</p>
<p>Musium has been an evolving project. It started out as an attempt to index
metadata about a collection of flac files, and expose that (and the files
themselves) over http to enable Chromecast playback. Later it pivoted to being
a music player with a webinterface but local playback, essentially a music
playback server.</p>
<p>Until February 2023, Musium did not tag releases, I just ran <code>master</code> locally,
rebuilding and restarting it after every change. Essentially there was only the
“nightly” version. But now that I do want to start tracking changes, this
particular version makes sense as the initial release, as it marks the point
where I started using Musium personally.</p>
<p>Features included:</p>
<ul>
<li>Fast indexing.</li>
<li>A webinterface to browse the library and start tracks.</li>
<li>Logging of listens to a file as <abbr>JSON</abbr>.</li>
<li>Advanced search.</li>
</ul>
      </article>
      <nav id="nav-prev-next">
        <a id="nav-prev" href="../disks/" title="Disks">Previous</a>
        <a id="nav-next" href="../api/" title="API Reference">Next</a>
        </nav>
      </div>
    <aside>
      <nav>
        <ul>
        <li class="toc-section"><a href="..">Overview</a></li>
          <li class="toc-section
            "><a href="../building/">User Guide</a></li>
          
            <li class="toc-chapter
              "><a href="../building/">Building</a></li>
            
            <li class="toc-chapter
              "><a href="../configuration/">Configuration</a></li>
            
            <li class="toc-chapter
              "><a href="../running/">Running</a></li>
            
            <li class="toc-chapter
              "><a href="../webinterface/">Webinterface</a></li>
            
            <li class="toc-chapter
              "><a href="../tagging/">Tagging</a></li>
            
            <li class="toc-chapter
              "><a href="../loudness/">Loudness normalization</a></li>
            
            <li class="toc-chapter
              "><a href="../scrobbling/">Scrobbling to Last.fm</a></li>
            
            <li class="toc-chapter
              "><a href="../listenbrainz/">Submitting to Listenbrainz</a></li>
            
            <li class="toc-chapter
              "><a href="../tradfri/">Trådfri control</a></li>
            
            <li class="toc-chapter
              "><a href="../disks/">Disks</a></li>
            
            <li class="toc-chapter
               current"><a href="./">Changelog</a></li>
            <li><ul>
                <li class="toc-heading"><a href="#versioning-policy">Versioning policy</a></li>
                <li class="toc-heading"><a href="#unreleased">Unreleased</a></li>
                <li class="toc-heading"><a href="#0110">0.11.0</a></li>
                <li class="toc-heading"><a href="#0101">0.10.1</a></li>
                <li class="toc-heading"><a href="#0100">0.10.0</a></li>
                <li class="toc-heading"><a href="#090">0.9.0</a></li>
                <li class="toc-heading"><a href="#080">0.8.0</a></li>
                <li class="toc-heading"><a href="#070">0.7.0</a></li>
                <li class="toc-heading"><a href="#060">0.6.0</a></li>
                <li class="toc-heading"><a href="#050">0.5.0</a></li>
                <li class="toc-heading"><a href="#040">0.4.0</a></li>
                <li class="toc-heading"><a href="#031">0.3.1</a></li>
                <li class="toc-heading"><a href="#030">0.3.0</a></li>
                <li class="toc-heading"><a href="#020">0.2.0</a></li>
                <li class="toc-heading"><a href="#010">0.1.0</a></li>
                </ul></li>
               <li class="toc-section"><a href="../api/">API Reference</a></li>
          <li class="toc-section
            "><a href="../search/">Internals</a></li>
          
            <li class="toc-chapter
              "><a href="../search/">Search</a></li>
            
            <li class="toc-chapter
              "><a href="../performance/">Performance</a></li>
            
            <li class="toc-chapter
              "><a href="../thumbnails/">Thumbnails</a></li>
            </ul>
      </nav>
    </aside>
  </div>
</body>
</html>